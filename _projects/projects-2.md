---
title: "Improving Machine Learning Algorithms for RF Breast Cancer Detection"
excerpt: "Investigating new feature extraction methods and improving training efficiency for ensemble cost-sensitive SVM algorithm for breast cancer detection using RF radar."
date: 2019-06-20
collection: projects
---

# Introduction
A cost-sensitive ensemble support vector machine (SVM) classification algorithm for the detection of the divergence of breast tissue from a healthy baseline condition, using the multistatic radar scans produced by the system, has been developed. High detection accuracy has be achieved on a dataset comprising scans of synthetic, carbon-based, breast phantoms. However, lower accuracy was achieved on a dataset comprising scans of human subjects with numerically simulated tumor responses injected into a subset of the scans. These results are reported in detail in [1]. One of my principal goals during my master's degree was to improve this algorithm in terms of predictive performance and computational efficiency.

# Background
Experimental evidence indicates that there is a substantial difference between the permittivities and conductivities of different types of breast tissue in the microwave frequency range, particularly between tumorous tissue and glandular/adipose tissue (normal breast tissues). When electromagnetic radiation in the microwave frequency range is incident on the boundary between two tissue types, the dielectric contrast causes a portion of the electromagnetic wave to be reflected. The larger the contrast between the two tissues that form the boundary, the larger the reflected portion of the incident radiation will be. By analyzing the reflections produced at these tissue boundaries we can make inferences about the nature of the tissue being illuminated.
<br><br>
The [McGill RF Breast Cancer Screening Group](http://www.compem.ece.mcgill.ca/breast-cancer-detection/index.html) has developed a prototype 16-element multistatic radio-frequency radar system for breast cancer monitoring. The hardware system is capable of recording a radar scan of a hemisphereical or breast-shaped subject using 16 the transmitting and receiving antennas. The 16 antennas are activated in individual transmit-receive pairs to capture the radar signals, in other words, each antenna transmits a pulse while another antenna records the scattered and transmitted signals. This produces a total of 240 signals per scan, one signal for each uni-directional pair of antennas in the array.

# Python Implementation
The ensemble SVM classifier was originally written in <a href="https://www.mathworks.com/products/matlab.html">MATLAB</a>. In order to take better advantage of advancements in machine learning algorithms in the future a conversion to [Python](https://www.python.org/) was performed. The [2$\nu$-SVM](https://www.ece.rice.edu/dsp/software/nusvm.shtml) base models used in the original implementation were not used in the Python implementation because an equivalently efficient library to generate these models did not exist, therefore using these models was not feasible. Instead, the [scikit learn SVC](https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html) was used to generate base models with the optional negative class weight parameter used to control the cost-sensitivity of the models. The work in the following sections was conducted using this new Python implementation. Since the classification accuracy achieved for the synthetic phantom dataset was so high, the dataset comprising modified human scans (clinical dataset) was used to evaluate the proposed modifications to the algorithm.

# Improving Feature Extraction Methods
The original detection algorithm used principle component analysis (PCA) as a feature extraction method. While previous results clearly indicated its effectiveness, more deterministic feature extraction methods could be equally effective with the added advantage of being more interpretable. The performance of 4 new feature extraction methods were investigated: short-time Fourier transform (STFT) features, discrete Fourier transform (DFT) features, empirical mode decomposition (EMD) features and time-domain features (TDF).

The figure below shows receiver operating characteristic curves for the classifier when each feature extraction method was used. The curves were generated by varying the false positive target rate parameter of the [Neyman-Pearson score metric](http://www.stat.rice.edu/~cscott/pubs/npdesign.pdf) used to guide the selection of ensemble models over a range of values between approximately 0% and 100%.

<img src="/images/fc_roc.png" alt="ROC curves for investigated features" height="250px">

# Improving Ensemble Training Efficiency    
The ensemble algorithm involved performing a grid search over a few thousand hyperparameter combinations, for each pair of antennas that has been selected for the analysis (there can be up to 240 antenna pairs used). Once these grid searches have been completed, the best hyperparameter combinations that yielded the best predictive performance are chosen to form the final ensemble model. Consequently, the computational load of training an ensemble classifier is significant. One aspect of my research was to investigate how the computational load of the ensemble training process could be reduced without compromising the model's predictive performance.
<br><br>
A wide variety of derivative-free optimization algorithms exist that may be applied to hyperparameter searching in machine learning applications. The following algorithms were chosen: random walk, simulated annealing, genetic algorithms and particle swarm optimization. However, the existing implementation considers all hyperparameter configurations from all selected antenna pairs. Therefore, these algorithms were used in a non-conventional way. Instead of searching for the single best hyperparameter configuration, an attempt was made to use these algorithms to explore the hyperparameter space in an intelligent manner and build a library of high quality models in a more efficient way than the implementation using the grid search. To do this, each algorithm was configured, where possible, to prioritize exploration over exploitation.
<br><br>
Some initial results are shown in the figures below. The number of objective function evaluations for each algorithm was limited to 1000, which yielded a speed-up of around x4. These figures show distributions of the Neyman-Pearson scores achieved when each search algorithm was used to explore the hyperparameter space. The meanings of the acronyms are as follows: RS = Random Search, RW = Random Walk, SA = Simulated Annealing, GA = Genetic Algorithm, PS = Particle Swarm Optimization. Each figures shows results for a different false positive target rate, (5%, 10% and 20% respectively). In each figure the dashed red line indicates the Neyman-Pearson score achieved using the grid search.

<img src="/images/hps_nps_boxplot_a005.png" alt="hyperparameter search neyman pearson scores" height="250px">
<img src="/images/hps_nps_boxplot_a01.png" alt="hyperparameter search neyman pearson scores" height="250px">
<img src="/images/hps_nps_boxplot_a02.png" alt="hyperparameter search neyman pearson scores" height="250px">


# Discussion

...

# References

[1] | Y. Li, E. Porter, A. Santorelli, M. PopoviÄ‡, M. Coates. Microwave breast cancer detection via cost-sensitive ensemble classifiers: Phantom and patient investigation, Biomedical Signal Processing and Control, Volume 31, 2017, pp. 366-376. (<https://www.sciencedirect.com/science/article/abs/pii/S174680941630129X>)
