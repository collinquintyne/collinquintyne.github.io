<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    # Introduction
    A cost-sensitive ensemble support vector machine (SVM) classification algorithm for the detection of the divergence of breast tissue from a healthy baseline condition, using the multistatic radar scans, has been developed. High detection accuracy has be achieved on a dataset comprising scans of synthetic, carbon-based, breast phantoms. However, lower accuracy was achieved on a dataset comprising scans of human subjects with numerically simulated tumor responses injected into a subset of the scans. These results are reported in detail in [1]. One of my principal goals during my master's degree was to improve this algorithm in terms of predictive performance and computational efficiency.

    # Background
    Experimental evidence indicates that there is a substantial difference between the permittivities and conductivities of different types of breast tissue in the microwave frequency range, particularly between tumorous tissue and glandular/adipose tissue (normal breast tissues) [2],[3]. When electromagnetic radiation in the microwave frequency range is incident on the boundary between two tissue types, the dielectric contrast causes a portion of the electromagnetic wave to be reflected. The larger the contrast between the two tissues that form the boundary, the larger the reflected portion of the incident radiation will be. By analyzing the reflections produced at these tissue boundaries we can make inferences about the nature of the tissue being illuminated.
    <br><br>
    The [McGill RF Breast Cancer Screening Group](http://www.compem.ece.mcgill.ca/breast-cancer-detection/index.html) has developed a prototype 16-element multistatic radio-frequency radar system for breast cancer monitoring. The hardware system is capable of recording a radar scan of a hemisphereical or breast-shaped subject using 16 the transmitting and receiving antennas. The 16 antennas are activated in individual transmit-receive pairs to capture the radar signals, in other words, each antenna transmits a pulse while another antenna records the scattered and transmitted signals. This produces a total of 240 signals per scan, one signal for each uni-directional pair of antennas in the array.

    # Python Implementation
    The ensemble SVM classifier was originally written in MATLAB. In order to more easily take advantage of advancements in machine learning algorithms in the future a conversion to Python was performed. The [2$\nu$-SVM](https://www.ece.rice.edu/dsp/software/nusvm.shtml) base models used in the original implementation were not used in the Python implementation because an equivalently efficient library to generate these models did not exist, therefore using these models was not feasible. Instead, the [scikit learn SVC](https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html) was used to generate base models with the optional negative class weight parameter used to control the cost-sensitivity of the models. This Python implementation was used to investigate potential improvements.

    # Improving Feature Extraction Methods
    The original detection algorithm used principle component analysis (PCA) as a feature extraction method. While previous results clearly indicated its effectiveness, more deterministic feature extraction methods could be equally effective with the added advantage of being more interpretable. The performance of 4 new feature extraction methods were investigated: short-time Fourier transform (STFT) features, discrete Fourier transform (DFT) features, empirical mode decomposition (EMD) features and time-domain features (TDF).
    <br><br>
    The figure below shows receiver operating characteristic curves for the classifier when each feature extraction method was used. The curves were generated by varying the false-positive target rate parameter of the [Neyman-Pearson score metric](http://www.stat.rice.edu/~cscott/pubs/npdesign.pdf) used to guide the selection of ensemble models over a range of values between approximately 0% and 100%. The results indicate that these new methods yield better predictive performance than PCA.
    <br>
    ![ROC curves for investigated features](/images/fc_roc.png)
    <br>
    *Receiver operating characteristic (ROC) curves for feature extraction investigation. The proposed feature extraction methods yield better results than PCA.*
    <br><br>

    # Improving Ensemble Training Efficiency
    The ensemble algorithm involved performing a grid search over a few thousand hyperparameter combinations, for each pair of antennas that has been selected for the analysis (there can be up to 240 antenna pairs used). Once these grid searches have been completed, the best hyperparameter combinations that yielded the best predictive performance are chosen to form the final ensemble model. Consequently, the computational load of training an ensemble classifier is significant. One aspect of my research was to investigate how the computational load of the ensemble training process could be reduced without compromising the model's predictive performance.
    <br><br>
    A wide variety of derivative-free optimization algorithms exist that may be applied to hyperparameter searching in machine learning applications. I chose to use the following algorithms: random search (RS), random walk (RW), simulated annealing (SA), genetic algorithms (GA) and particle swarm optimization (PS). However, the existing implementation considers all hyperparameter configurations from all selected antenna pairs. Therefore, I attempted to use these algorithms in an unconventional way. Instead of searching for the single best hyperparameter configuration, I attempted to use these algorithms to explore the hyperparameter space in an intelligent manner and build a library of high quality models in a more efficient way than the implementation using the grid search. To do this, each algorithm was configured, where possible, to prioritize exploration over exploitation.
    <br><br>
    The initial results were encouraging. The figure below shows the distribution of Neyman-Pearson scores over 10 trials for a false-positive target rate of 5%, (lower is better). The random search (RS), genetic algorithm (GA) and particle swarm (PS) searches all yielded better performance than the exhaustive grid search. A possible explanation might be because the exhaustive grid search introduces a larger number of redundant models, (models whose behaviors only vary  slightly, if at all), to the model library than these searches and consequently limits the diversity of the ensemble. However further investigation is required to conclude this.
    <br>
    ![Neyman-Pearson score distributions for hyperparameter search algorithms](/images/hps_bp_a005.png)
    <br>
    *Boxplots of Neyman-Pearson scores achieved by the ensemble model when hyperparameter search algorithms are used to build the model library. The red line represents the performance achieved when an exhaustive grid search is used instead.*
    <br><br>

    # Improving Ensemble Selection
    The original classifier described in [1] builds a model ensemble by simply selecting the best individual models. Perhaps a more sophisticated selection procedure might yield a more optimal model ensemble and therefore, better predictive performance. I used a forward-stepwise selection method described in Caruana et al. in [4]. Several of the additional methods for improving the performance of the selection algorithm were also investigated, including: selection with and without replacement and multiple model initialization. This method failed to improve the predictive performance on the clinical dataset. One possible explanation for this is that, the small dataset size caused the selection algorithm to overfit to the validation set and consequently produce a final model with relatively poor generalization.

    <!-- # Discussion
    Because the relatively small "clinical" dataset was used in these investigations, the confidence with which these investigations might be concluded is limited. -->

    # References

    [1] | Y. Li, E. Porter, A. Santorelli, M. Popović, M. Coates. "Microwave breast cancer detection via cost-sensitive ensemble classifiers: Phantom and patient investigation," Biomedical Signal Processing and Control, vol. 31, pp. 366-376, 2017. (<https://www.sciencedirect.com/science/article/abs/pii/S174680941630129X>)
    [2] | M. Lazebnik, L. McCartney, D. Popovic, et al., "A large-scale study of the ultrawideband microwave dielectric properties of normal, benign and malignant breast tissues obtained from cancer surgeries," Physics in Medicine & Biology, vol. 52, no. 20, pp. 6093-6115, 2007.
    [3] | T. Sugitani, S. Kubota, S. Kuroki, et al., "Complex permittivities of breast tumor tissues obtained from cancer surgeries," Appl. Physics Lett., vol. 104, no. 25, pp. 3702-3707, 2014.
    [4] | R. Caruana, A. Niculescu-Mizil, G. Crew, and A. Ksikes, “Ensemble selection from libraries of models,” in Proc. 2004 21st Int. Conf. on Machine Learning, Jul. 2004, pp. 18–26

  </body>
</html>
